!function(n,t){"use strict";"object"==typeof module&&module.exports?module.exports=t():"function"==typeof define&&define.amd?define([],t):n.thunks=t()}("object"==typeof window?window:this,function(){"use strict";function n(n){return"function"==typeof n}function t(t){return n(t)&&t._isThunk===d}function r(n){if(n)throw n}function u(n,t){if(t=t||0,t>=n.length)return[];for(var r=n.length,u=Array(r-t);r-->t;)u[r-t]=n[r];return u}function e(n,t,r){if(r)for(var u=0,e=n.length;e>u;u++)t(n[u],u,n);else for(var l in n)n.hasOwnProperty(l)&&t(n[l],l,n)}function l(n,t,r){var u=[null,null];try{u[1]=t.apply(n,r)}catch(e){u[0]=e}return u}function o(t){return t?(n(t)?t=i(t):n(t.toThunk)?t=i(t.toThunk()):n(t.then)&&(t=i(f(t))),t):t}function i(n){return n._isThunk=d,n}function c(n){return function(r){var i,c=1,f=!1,a=y(n);if(a?i=Array(n.length):n&&"object"==typeof n&&(i={}),!i)return r(new Error("Not array or object"));var s=l(null,function(n,t){return e(n,t,a),--c||f?void 0:r(null,i)},[n,function(n,e){return f?void 0:(c++,n=o(n),t(n)?(n(function(n,t){return f?void 0:null!=n?(f=!0,r(n)):(i[e]=arguments.length>2?u(arguments,1):t,--c||r(null,i))}),void 0):(i[e]=n,--c||r(null,i)))}])[0];s&&(f=!0,r(s))}}function f(n){return function(t){return n.then(function(n){t(null,n)},t)}}function a(n){function e(t){var e=u(arguments);if(f.debug&&f.debug.apply(null,e),null!=t){if(e=[t],f.onerror){if(f.onerror(t)!==!0)return;e=[null]}}else e[0]=null;return n.callback===r?r(t):(c.result=l(n.ctx,n.callback,e),c.callback&&a(c),void 0)}var i,c=n.next,f=n.scope,s=n.result;if(s!==!1){if(n.result=!1,s[0])return e(s[0]);if(i=o(s[1]),!t(i))return null==i?e(null):e(null,i);var h=l(n.ctx,i,[e])[0];return h?e(h):null}}function s(n){return n.next={ctx:n.ctx,scope:n.scope,next:null,callback:null,result:null},i(function(t){return h(n,t)})}function h(n,t){return n.callback=t||r,n.result&&a(n),s(n.next)}function p(t){function r(n){var t={ctx:this===r?null:this,scope:e,next:null,callback:null,result:[null,n]};return s(t)}var e={onerror:null,debug:null};return n(t)?e.onerror=t:t&&(n(t.debug)&&(e.debug=t.debug),n(t.onerror)&&(e.onerror=t.onerror)),r.all=function(n){return r.call(this,c(n))},r.digest=function(){var n=arguments;return r.call(this,function(t){t.apply(null,n)})},r.thunkify=function(n){var t=this===r?null:this;return function(){var e=u(arguments);return r.call(t||this,function(t){e.push(t),n.apply(this,e)})}},r.delay=function(n){return r.call(this,function(t){setTimeout(t,n)})},r}var d={},v=Object.prototype.toString,y=Array.isArray||function(n){return"[object Array]"===v.call(n)};return p.NAME="thunks",p.VERSION="v1.4.0",p});