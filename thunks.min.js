!function(n,t){"use strict";"object"==typeof module&&module.exports?module.exports=t():"function"==typeof define&&define.amd?define([],t):n.thunks=t()}("object"==typeof window?window:this,function(){"use strict";function n(n){return n&&n.constructor===Object}function t(n){return"function"==typeof n}function r(n){return n&&n._isThunk===m}function u(n){return t(n.next)&&t(n.throw)}function e(n){return n&&n.constructor&&"GeneratorFunction"===n.constructor.name}function l(n){if(null!=n)throw n}function o(n,t){if(t=t||0,t>=n.length)return[];for(var r=n.length,u=Array(r-t);r-->t;)u[r-t]=n[r];return u}function c(n,t,r){var u=[null,null];try{u[1]=t.apply(n,r)}catch(e){u[0]=e}return u}function i(r,e){return r?(t(r)?r=f(r):u(r)?r=f(a(r)):t(r.toThunk)?r=f(r.toThunk()):t(r.then)?r=f(g(r)):e&&(k(r)||n(r))&&(r=f(s(r))),r):r}function f(n){return n._isThunk=m,n}function a(n){return function(t){function u(u,o){var f=null==u?n.next(o):n.throw(u);if(f.done)return t(null,f.value);var a=i(f.value,!0);return r(a)?l--?a.call(c,e):(w(function(){l=b;try{a.call(c,e)}catch(n){return t(n)}}),void 0):e(null,a)}function e(n,r){arguments.length>2&&(r=o(arguments,1));try{u(n,r)}catch(e){return t(e)}}var l=b,c=this;return e()}}function s(t){return function(u){function e(n){if(k(n))for(var t=0,r=n.length;r>t;t++)l(n[t],t);else for(var e in n)n.hasOwnProperty(e)&&l(n[e],e);return--f||a?void 0:u(null,c)}function l(n,t){return a?void 0:(f++,n=i(n),r(n)?(n(function(n,r){return a?void 0:null!=n?(a=!0,u(n)):(c[t]=arguments.length>2?o(arguments,1):r,--f||u(null,c))}),void 0):(c[t]=n,--f||u(null,c)))}var c,f=1,a=!1;if(k(t)?c=Array(t.length):n(t)&&(c={}),!c)return u(new Error("Not array or object"));try{e(t)}catch(s){return a=!0,u(s)}}}function h(n){return function(t){function u(n){if(n=i(n,!0),!r(n))return e(null,n);try{n(e)}catch(u){return t(u)}}function e(r,e){return null!=r?t(r):(a[l]=arguments.length>2?o(arguments,1):e,++l>c?t(null,a):f--?u(n[l]):(w(function(){f=b,u(n[l])}),void 0))}var l=0,c=n.length-1,f=b,a=Array(n.length);return 0>c?t(null,a):(u(n[0]),void 0)}}function g(n){return function(t){return n.then(function(n){t(null,n)},t)}}function v(n){function t(t){if(n.result!==!1){n.result=!1;var r=o(arguments);if(f.debug&&f.debug.apply(null,r),null==t)r[0]=null;else if(r=[t],f.onerror){if(f.onerror(t)!==!0)return;r=[null]}return n.callback===l?l(t):(u.result=c(n.ctx,n.callback,r),u.callback?v(u):(null!=u.result[0]&&w(function(){u.result&&l(u.result[0])}),void 0))}}var u=n.next,f=n.scope,s=n.result;if(s!==!1){if(null!=s[0])return t(s[0]);if(s=i(s[1]),!r(s))return null==s?t(null):t(null,s);e(s)&&(s=a(s.call(n.ctx)));var h=c(n.ctx,s,[t])[0];return h&&t(h)}}function d(n){return n.next={ctx:n.ctx,scope:n.scope,callback:null,result:null},f(function(t){return y(n,t)})}function y(n,t){return n.callback=t||l,n.result&&v(n),d(n.next)}function p(n){function r(n){var t={ctx:this===r?null:this,scope:u,result:[null,n]};return d(t)}var u={onerror:null,debug:null};return t(n)?u.onerror=n:n&&(t(n.debug)&&(u.debug=n.debug),t(n.onerror)&&(u.onerror=n.onerror)),r.all=function(n){return r.call(this,s(n))},r.seq=function(n){return 1===arguments.length&&k(n)||(n=arguments),r.call(this,h(n))},r.digest=function(){var n=arguments;return r.call(this,function(t){t.apply(null,n)})},r.thunkify=function(n){var t=this===r?null:this;return function(){var u=o(arguments);return r.call(t||this,function(t){u.push(t),n.apply(this,u)})}},r.delay=function(n){return r.call(this,function(t){setTimeout(t,n)})},r}var m={},b=100,x=Object.prototype.toString,k=Array.isArray||function(n){return"[object Array]"===x.call(n)},w="function"==typeof setImmediate?setImmediate:function(n){setTimeout(n,0)};return p.NAME="thunks",p.VERSION="v2.0.0",p});